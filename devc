#!/usr/bin/env bash

set -e # Fail on first error

if [[ $# -lt 1 || $# -gt 3 || ( "$1" == "--init" && $# -lt 2 ) ]]; then
    echo "Usage: devc [--init] <name> [<mount>]"
    exit 1
fi

if [[ "$1" == "--init" ]]; then
    if [[ $# -eq 3 ]]; then
        MOUNT_DIR=$3
    else
        MOUNT_DIR=$2
    fi

    mkdir -p $HOME/devc/$MOUNT_DIR
    MOUNT="--mount type=bind,src=$HOME/devc/$MOUNT_DIR,dst=/root/$MOUNT_DIR"

    docker run \
        -it \
        $MOUNT \
        --name $2 \
        devc bash
    exit 0
fi

docker start -i $1
